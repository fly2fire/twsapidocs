<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>TWS API: Market Data</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script>
$(document).ready(function(){
    $("ul#tabs li").click(function(e){
        if (!$(this).hasClass("active")) {
            var tabNum = $(this).index();
            var nthChild = tabNum+1;
            $("ul#tabs li.active").removeClass("active");
            $(this).addClass("active");
            $("ul#tab li.active").removeClass("active");
            $("ul#tab li:nth-child("+nthChild+")").addClass("active");
        }
    });
});
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="ib_theme.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0" >
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li></ul>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('market_data.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Market Data </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Using the TWS API, you can request realtime market data for trading and analysis. </p>
<h1><a class="anchor" id="md_request"></a>
Requesting</h1>
<p>In order to receive live quotes, you must first make the request call via <a class="el" href="classIBApi_1_1EClient.html#a5b7d2f3048b2be5c9c3a87c18fb01dd3">IBApi.EClient.reqMktData</a> within your API program: </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tickerId</td><td>- A unique identifier for this request </td></tr>
    <tr><td class="paramname">contract</td><td>- The contract for which we are requesting the data </td></tr>
    <tr><td class="paramname">genericTickList</td><td>- see Generic ticks section below </td></tr>
    <tr><td class="paramname">snapshot</td><td>- see Snapshots section below </td></tr>
    <tr><td class="paramname">mktDataOptions</td><td>- set always to null</td></tr>
  </table>
  </dd>
</dl>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.reqMktData(1001, ContractSamples.StockComboContract(), <span class="keywordtype">string</span>.Empty, <span class="keyword">false</span>, null);</div>
<div class="line">            client.reqMktData(1002, ContractSamples.FuturesOnOptions(), <span class="keywordtype">string</span>.Empty, <span class="keyword">false</span>, null);</div>
</div><!-- fragment -->  </li>
<li>
</li>
<li>
</li>
<li>
</li>
</ul>
<h1><a class="anchor" id="md_receive"></a>
Receiving</h1>
<p>After subscribing to the ticker stream, your API client will receive the data supplied by the TWS API server via several methods. In your API client code, you will need to implement these methods to manipulate the data relayed back to the client:</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl : EWrapper </div>
<div class="line">    {</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> tickPrice(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> field, <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> canAutoExecute) </div>
<div class="line">        {</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Tick Price. Ticker Id:&quot;</span>+tickerId+<span class="stringliteral">&quot;, Field: &quot;</span>+field+<span class="stringliteral">&quot;, Price: &quot;</span>+price+<span class="stringliteral">&quot;, CanAutoExecute: &quot;</span>+canAutoExecute+<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">        }</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> tickSize(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> field, <span class="keywordtype">int</span> size)</div>
<div class="line">        {</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Tick Size. Ticker Id:&quot;</span> + tickerId + <span class="stringliteral">&quot;, Field: &quot;</span> + field + <span class="stringliteral">&quot;, Size: &quot;</span> + size+<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">        }</div>
</div><!-- fragment --> ....  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>SampleFrame <span class="keyword">extends</span> JFrame implements EWrapper {</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> tickPrice( <span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> field, <span class="keywordtype">double</span> price, <span class="keywordtype">int</span> canAutoExecute) {</div>
<div class="line">        <span class="comment">// received price tick</span></div>
<div class="line">        String msg = EWrapperMsgGenerator.tickPrice( tickerId, field, price, canAutoExecute);</div>
<div class="line">        m_tickers.add( msg );</div>
<div class="line">    }</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> tickSize( <span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> field, <span class="keywordtype">int</span> size) {</div>
<div class="line">        <span class="comment">// received size tick</span></div>
<div class="line">        String msg = EWrapperMsgGenerator.tickSize( tickerId, field, size);</div>
<div class="line">        m_tickers.add( msg);</div>
<div class="line">    }</div>
</div><!-- fragment --> ....  </li>
<li>
</li>
<li>
</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="interfaceIBApi_1_1EWrapper.html#aff4ae3269d7b13dd1ca989a8d5ca1ced" title="Market data tick price callback. Handles all price related ticks. ">IBApi::EWrapper::tickPrice</a> <a class="el" href="interfaceIBApi_1_1EWrapper.html#a1844eb442fb657c0f2cc0a63e4e74eba">IBApi.EWrapper.tickSize</a> <a class="el" href="interfaceIBApi_1_1EWrapper.html#a9901f14408b7a6f75b1d06e3e6196a26">IBApi.EWrapper.tickGeneric</a> <a class="el" href="interfaceIBApi_1_1EWrapper.html#a19cb7c5bbd4ab05ccc5f9e686ed07a9e">IBApi.EWrapper.tickString</a></dd></dl>
<p>For a list of available tick types please refer to (link to tick types page)</p>
<h1><a class="anchor" id="md_cancel"></a>
Cancelling</h1>
<p>Once an active market data request is no longer needed, it can be cancelled via the <a class="el" href="classIBApi_1_1EClient.html#af443a1cd993aee33ce67deb7bc39e484" title="Cancels a RT Market Data request. ">IBApi::EClient::cancelMktData</a> method: </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tickerId</td><td>- the unique identifier given to the original request.</td></tr>
  </table>
  </dd>
</dl>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.cancelMktData(1001);</div>
<div class="line">            client.cancelMktData(1002);</div>
<div class="line">            client.cancelMktData(1003);</div>
</div><!-- fragment -->  </li>
<li>
</li>
<li>
</li>
<li>
</li>
</ul>
<h1><a class="anchor" id="md_snapshot"></a>
Snapshots</h1>
<p>It is possible to simply obtain the current state of the market once rather than keeping an open subscription. By invoking the <a class="el" href="classIBApi_1_1EClient.html#a5b7d2f3048b2be5c9c3a87c18fb01dd3" title="Requests real time market data. This function will return the product&#39;s market data. It is important to notice that only real time data can be delivered via the API. ">IBApi::EClient::reqMktData</a> function passing in <span style="font-weight:bold;">true</span> for the snapshot parameter, the client application will receive the currently available market data once before a IBApi::EClient::tickSnapshotEnd event is sent: </p>
<h4>Snapshot request:</h4>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.reqMktData(1003, ContractSamples.FutureComboContract(), <span class="keywordtype">string</span>.Empty, <span class="keyword">true</span>, null);</div>
</div><!-- fragment -->  </li>
<li>
</li>
<li>
</li>
<li>
</li>
</ul>
<h4>End marker reception:</h4>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl : EWrapper </div>
<div class="line">    {</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> tickSnapshotEnd(<span class="keywordtype">int</span> tickerId)</div>
<div class="line">        {</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;TickSnapshotEnd: &quot;</span>+tickerId+<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">        }</div>
</div><!-- fragment -->  </li>
<li>
</li>
<li>
</li>
<li>
</li>
</ul>
<h1><a class="anchor" id="genticks"></a>
Generic Ticks</h1>
<p>Brief description of these + links to a page having the generic ticks table. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright IB 2015 </li>
  </ul>
</div>
</body>
</html>
